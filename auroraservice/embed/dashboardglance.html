<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="https://liveg-technologies.github.io/auroraservice/borealis.css">
		<link href="https://fonts.googleapis.com/css?family=Bitter|Montserrat" rel="stylesheet">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
		<script src="https://www.gstatic.com/firebasejs/4.12.0/firebase.js"></script>
		<script src="https://liveg-technologies.github.io/auroraservice/bappapi.js"></script>
		<script defer="" src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
	</head>
	<body>
        <div id="content" class="serif left">
		    <h1>Loading...</h1>
        </div>
	</body>
	<script>
		app.load("Webcount", "webcount");

        $.getJSON("https://ipapi.co/json", function(data) {
            var country = data.region;

            app.onLoginChange(function(loggedIn) {
                if (loggedIn == true) {
                    app.readOnChange("selected", function(key) {
                        if (key != null) {
                            app.readListOnChange("sites/" + key + "/data", function(data, key) {
                                if (key == "visits") {
                                    document.getElementById("visits").innerHTML = data + " Visits";
                                } else if (key == "locations") {
                                    document.getElementById("country").innerHTML = data[country]["visits"] + " in this country";
                                } else if (key == "bots") {
                                    document.getElementById("bots").innerHTML = data + " bots, not included";
                                } else if (key == "mins") {
                                    document.getElementById("mins").innerHTML = data + " minutes total viewing";
                                }
                            }, function(data) {
                                document.getElementById("content").innerHTML = "<h1 id='visits'>--- Visits</h1><h2 id='country'>--- in this country</h2><h2 id='bots'>--- bots, not included</h2><h2 id='mins'>--- minutes total viewing</h2>";
                            });
                        } else {
                            document.getElementById("content").innerHTML = "<h1 id='visits'>--- Visits</h1><h2 id='country'>--- in this country</h2><h2 id='bots'>--- bots, not included</h2><h2 id='mins'>--- minutes total viewing</h2>";
                        }
                    });
                } else {
                    document.getElementById("content").innerHTML = "<h1 id='visits'>--- Visits</h1><h2 id='country'>--- in this country</h2><h2 id='bots'>--- bots, not included</h2><h2 id='mins'>--- minutes total viewing</h2>";
                }
            });
        });
	</script>
</html>